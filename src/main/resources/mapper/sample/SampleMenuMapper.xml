<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="nhc.erp.sample.mapper.SampleMenuMapper">
    <select id="selectMenuList" parameterType="nhc.erp.sample.vo.SampleMenuVo" resultType="java.util.Map">
    	/* SampleMenuMapper.selectMenuList */
		SELECT ME.MENU_CD
		 	 , ME.MENU_NM
		 	 , ME.PARENT_MENU_CD
		 	 , ME.PARENT_MENU_CD
		 	 , ME.MENU_LEVEL
		 	 , ME.PROGRAM_CD
		 	 , PR.SRC_PATH
		  FROM BM_MENU ME LEFT OUTER JOIN BM_PROGRAM PR ON ME.PROGRAM_CD = PR.PROGRAM_CD
			   			  LEFT OUTER JOIN BM_PROGRAM_AUTHORITY AP ON PR.PROGRAM_CD = AP.PROGRAM_CD
			   			  LEFT OUTER JOIN HM_MEMBER_AUTHORITY MA ON AP.AUTHORITY_CD = MA.AUTHORITY_CD
		 WHERE ME.PROGRAM_CD IS NULL
			OR ME.PROGRAM_CD = ''
			OR MA.EMP_CD = #{empCd}
		   AND ME.IS_USE = 'Y'
		   AND PR.IS_USE = 'Y'
	  ORDER BY ME.MENU_CD ASC, ME.SORT_ORDER ASC
    </select>
    <select id="selectFavoriteListByEmpCd" parameterType="nhc.erp.sample.vo.SampleMenuVo" resultType="java.util.Map">
    	/* SampleMenuMapper.selectFavoriteListByEmpCd */
		SELECT M.MENU_CD
			 , M.MENU_NM
			 , M.SRC_PATH
		  FROM (SELECT M.MENU_CD
		  			 , M.MENU_NM
		  			 , P.SRC_PATH 
				  FROM BM_MENU M, BM_PROGRAM P
				 WHERE M.PROGRAM_CD = P.PROGRAM_CD
				   AND M.IS_USE = 'Y'
				) M INNER JOIN (SELECT EMP_CD
									 , MENU_CD 
								  FROM BM_FAVORITE 
								 WHERE EMP_CD = #{empCd}
							   ) F ON F.MENU_CD = M.MENU_CD
	   ORDER BY M.MENU_NM ASC
    </select>
    <select id="selectProgramAuthorityList" parameterType="nhc.erp.sample.vo.SampleMenuVo" resultType="java.util.Map">
    	/* SampleMenuMapper.selectProgramAuthorityList */
		SELECT DISTINCT PA.PROGRAM_CD
			 , PA.IS_AUTH_SELECT
			 , PA.IS_AUTH_SAVE
			 , PA.IS_AUTH_EXCEL
		  FROM HM_MEMBER_AUTHORITY MA INNER JOIN BM_PROGRAM_AUTHORITY PA ON MA.AUTHORITY_CD = PA.AUTHORITY_CD
		 WHERE MA.EMP_CD = #{empCd}
	</select>
</mapper>